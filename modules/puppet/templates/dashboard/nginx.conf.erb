server {
  listen 8084;

  root /usr/share/puppet-dashboard/public;

  satisfy any;

  allow 127.0.0.1;
  allow <%= ipaddress_preferred %>;
  deny all;

  auth_basic 'Rubaidh Ops';
  auth_basic_user_file /etc/nginx/htpasswd;

  location / {
    try_files $uri/index.html $uri.html $uri @puppet_dashboard;
  }

  location @puppet_dashboard {
    proxy_pass http://puppet_dashboard;
  }
}
